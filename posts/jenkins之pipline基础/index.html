<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
    <meta charset="UTF-8" />

    <meta name="generator" content="Hugo 0.79.1" /><meta name="theme-color" content="#fff" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no" />
    
    <meta http-equiv="Cache-Control" content="no-transform" />
    
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <title>jenkins之pipline基础 | latte Studio</title>

    <link rel="stylesheet" href="/css/meme.min.6ee839ebe871493078f0e5a50ad2f711ca5c3eb967df636eec85b86acae78122.css"/>

    
    
        <script src="/js/meme.min.f936694a66257ff5d62ce2cc69be181f3f41519f7754c902363df674dcf35228.js"></script>

    

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=EB&#43;Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Noto&#43;Serif&#43;SC:wght@400;500;700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" media="print" onload="this.media='all'" />
        <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=EB&#43;Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Noto&#43;Serif&#43;SC:wght@400;500;700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" /></noscript>

    <meta name="author" content="latteStudio" /><meta name="description" content="jenkins之pipline基础" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#2a6df4" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="latte Studio" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="latte Studio" />
    <meta name="msapplication-starturl" content="../../" />
    <meta name="msapplication-TileColor" content="#fff" />
    <meta name="msapplication-TileImage" content="../../icons/mstile-150x150.png" />
    <link rel="manifest" href="/manifest.json" />

    
    

    
    <link rel="canonical" href="https://latteStudio.github.io/posts/jenkins%E4%B9%8Bpipline%E5%9F%BA%E7%A1%80/" />
    

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "datePublished": "2020-12-17T17:13:24+00:00",
        "dateModified": "2020-12-24T14:41:44+08:00",
        "url": "https://latteStudio.github.io/posts/jenkins%E4%B9%8Bpipline%E5%9F%BA%E7%A1%80/",
        "headline": "jenkins之pipline基础",
        "description": "jenkins之pipline基础",
        "inLanguage" : "zh-CN",
        "articleSection": "posts",
        "wordCount":  4980 ,
        "image": ["https://gitee.com/boogie96/img/raw/master/img/image-20201218154304160.png","https://gitee.com/boogie96/img/raw/master/img/image-20201218160356589.png","https://gitee.com/boogie96/img/raw/master/img/image-20201220110941441.png","https://gitee.com/boogie96/img/raw/master/img/image-20201220110919071.png","https://gitee.com/boogie96/img/raw/master/img/image-20201220125434792.png","https://gitee.com/boogie96/img/raw/master/img/image-20201220125628805.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221153205497.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221153349179.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221153554826.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221153837976.png","C:%5CUsers%5Cten%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201221153954730.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221154310911.png","C:%5CUsers%5Cten%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201221154339690.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221161730631.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221161544491.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221161213252.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221163852994.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221181943179.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221181910832.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221181846530.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221182723347.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221182920612.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221190051776.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221185947319.png","https://gitee.com/boogie96/img/raw/master/img/image-20201221185939578.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222103643458.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222112951995.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222113214450.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222122842520.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222135751403.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222135657676.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222135418655.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222142827860.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222143110199.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222141902445.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222141719048.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222145705844.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222145806495.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222153408963.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222154208757.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222154516647.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222154502371.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222160234405.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222160458710.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222160532068.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222161212519.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222161152581.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222162702295.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222162922286.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222163037525.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222163028400.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222163915687.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222164342638.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222164421018.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222170259808.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222170030916.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222170440452.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222171115778.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222171838919.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222172033337.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222175734878.png","https://gitee.com/boogie96/img/raw/master/img/image-20201222175644276.png"],
        "author": {
            "@type": "Person",
            "description": "KISS——Keep it simple, stupid~",
            "email": "boogies@163.com",
            "image": "https://latteStudio.github.io/icons/apple-touch-icon.png",
            "url": "latteStudio.github.io",
            "name": "latteStudio"
        },
        "license": "[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)",
        "publisher": {
            "@type": "Organization",
            "name": "latte Studio",
            "logo": {
                "@type": "ImageObject",
                "url": "https://latteStudio.github.io/icons/apple-touch-icon.png"
            },
            "url": "https://latteStudio.github.io/"
        },
        "mainEntityOfPage": {
            "@type": "WebSite",
            "@id": "https://latteStudio.github.io/"
        }
    }
</script>

    

<meta name="twitter:card" content="summary_large_image" />



    



<meta property="og:title" content="jenkins之pipline基础" />
<meta property="og:description" content="jenkins之pipline基础" />
<meta property="og:url" content="https://latteStudio.github.io/posts/jenkins%E4%B9%8Bpipline%E5%9F%BA%E7%A1%80/" />
<meta property="og:site_name" content="latte Studio" />
<meta property="og:locale" content="zh" /><meta property="og:image" content="https://gitee.com/boogie96/img/raw/master/img/image-20201218154304160.png" />
<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2020-12-17T17:13:24&#43;00:00" />
    <meta property="article:modified_time" content="2020-12-24T14:41:44&#43;08:00" />
    
    <meta property="article:section" content="posts" />



    
</head>

    <body>
        <div class="container">
            
    <header class="header">
        
            <div class="header-wrapper">
                <div class="header-inner single">
                    
    <div class="site-brand">
        
            <a href="/" class="brand">latte Studio</a>
        
    </div>

                    <nav class="nav">
    <ul class="menu" id="menu">
        
            
        
        
        
        
            
                <li class="menu-item"><a href="/posts/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon archive"><path d="M32 448c0 17.7 14.3 32 32 32h384c17.7 0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6 0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3 0 64v48c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"/></svg><span class="menu-item-name">归档</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon th"><path d="M149.333 56v80c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24h101.333c13.255 0 24 10.745 24 24zm181.334 240v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm32-240v80c0 13.255 10.745 24 24 24H488c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24zm-32 80V56c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm-205.334 56H24c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm386.667-56H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm0 160H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zM181.333 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24z"/></svg><span class="menu-item-name">分类</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/tags/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="icon tags"><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg><span class="menu-item-name">标签</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/about/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon user-circle"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><span class="menu-item-name">关于</span></a>
                </li>
            
        
            
                
                    
                    
                        <li class="menu-item">
                            <a id="theme-switcher" href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-light"><path d="M193.2 104.5l48.8-97.5a18 18 0 0128 0l48.8 97.5 103.4 -34.5a18 18 0 0119.8 19.8l-34.5 103.4l97.5 48.8a18 18 0 010 28l-97.5 48.8 34.5 103.4a18 18 0 01-19.8 19.8l-103.4-34.5-48.8 97.5a18 18 0 01-28 0l-48.8-97.5l-103.4 34.5a18 18 0 01-19.8-19.8l34.5-103.4-97.5-48.8a18 18 0 010-28l97.5-48.8-34.5-103.4a18 18 0 0119.8-19.8zM256 128a128 128 0 10.01 0M256 160a96 96 0 10.01 0"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-dark"><path d="M27 412a256 256 0 10154-407a11.5 11.5 0 00-5 20a201.5 201.5 0 01-134 374a11.5 11.5 0 00-15 13"/></svg></a>
                        </li>
                    
                
            
        
            
                
            
        
    </ul>
</nav>

                    
                </div>
            </div>
            
    <input type="checkbox" id="nav-toggle" aria-hidden="true" />
    <label for="nav-toggle" class="nav-toggle"></label>
    <label for="nav-toggle" class="nav-curtain"></label>


        
    </header>




            
            
    <main class="main single" id="main">
    <div class="main-inner">

        

        <article class="content post h-entry" data-align="justify" data-type="posts" data-toc-num="true">

            <h1 class="post-title p-name">jenkins之pipline基础</h1>

            

            
                <div class="post-description p-summary">jenkins之pipline基础</div>
                
            

            
                

<div class="post-meta">
    
        
        <time datetime="2020-12-17T17:13:24&#43;00:00" class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg>&nbsp;2020.12.17</time>
    
    
        
        <time datetime="2020-12-24T14:41:44&#43;08:00" class="post-meta-item modified dt-updated"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M400 64h-48V12c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v52H160V12c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v52H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 400H54a6 6 0 0 1-6-6V160h352v298a6 6 0 0 1-6 6zm-52.849-200.65L198.842 404.519c-4.705 4.667-12.303 4.637-16.971-.068l-75.091-75.699c-4.667-4.705-4.637-12.303.068-16.971l22.719-22.536c4.705-4.667 12.303-4.637 16.97.069l44.104 44.461 111.072-110.181c4.705-4.667 12.303-4.637 16.971.068l22.536 22.718c4.667 4.705 4.636 12.303-.069 16.97z"/></svg>&nbsp;2020.12.24</time>
    
    
    
        
        
        
            
                <span class="post-meta-item category"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>&nbsp;<a href="/categories/%E8%BF%90%E7%BB%B4/" class="category-link p-category">运维</a>/<a href="/categories/devops/" class="category-link p-category">devops</a></span>
            
        
    
    
        
        <span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;4980</span>
    
    
        
        <span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;10&nbsp;分钟</span>
    
    
    
</div>

            

            <nav class="contents">
  <h2 id="contents" class="contents-title">目录</h2><ol class="toc">
    <li><a id="contents:节点信息" href="#节点信息">节点信息</a></li>
    <li><a id="contents:安装jdk" href="#安装jdk">安装jdk</a></li>
    <li><a id="contents:安装tomcat" href="#安装tomcat">安装tomcat</a></li>
    <li><a id="contents:自定义webapp应用" href="#自定义webapp应用">自定义webapp应用</a></li>
    <li><a id="contents:部署keepalived" href="#部署keepalived">部署keepalived</a></li>
    <li><a id="contents:部署haproxy" href="#部署haproxy">部署haproxy</a></li>
  </ol>

  <ol>
    <li><a id="contents:安装gitlab相关插件" href="#安装gitlab相关插件">安装gitlab相关插件</a></li>
    <li><a id="contents:用户权限管理" href="#用户权限管理">用户权限管理</a></li>
    <li><a id="contents:jenkins邮箱配置" href="#jenkins邮箱配置">Jenkins邮箱配置</a></li>
    <li><a id="contents:jenkins配置ssh-key拉取gitlab代码" href="#jenkins配置ssh-key拉取gitlab代码">Jenkins配置ssh-key拉取gitlab代码</a></li>
    <li><a id="contents:jenkins配置ssh-key类型凭证" href="#jenkins配置ssh-key类型凭证">jenkins配置ssh-key类型凭证</a></li>
    <li><a id="contents:构建后shell脚本" href="#构建后shell脚本">构建后shell脚本</a></li>
  </ol>

  <ol>
    <li><a id="contents:触发器简介" href="#触发器简介">触发器简介</a></li>
    <li><a id="contents:触发器种类" href="#触发器种类">触发器种类</a></li>
    <li><a id="contents:触发器webhook设置" href="#触发器webhook设置">触发器webhook设置</a></li>
    <li><a id="contents:构建后项目关联" href="#构建后项目关联">构建后项目关联</a></li>
  </ol>

  <ol>
    <li><a id="contents:配置slave节点" href="#配置slave节点">配置slave节点</a></li>
  </ol>

  <ol>
    <li><a id="contents:简介" href="#简介">简介</a></li>
    <li><a id="contents:pipline语法" href="#pipline语法">pipline语法</a></li>
    <li><a id="contents:pipline简单测试" href="#pipline简单测试">pipline简单测试</a></li>
    <li><a id="contents:生成拉取代码的pipline语句" href="#生成拉取代码的pipline语句">生成拉取代码的pipline语句</a></li>
    <li><a id="contents:pipline做完整的代码部署流程" href="#pipline做完整的代码部署流程">pipline做完整的代码部署流程</a></li>
  </ol>

  <ol>
    <li><a id="contents:pipline视图" href="#pipline视图">pipline视图</a></li>
    <li><a id="contents:列表视图" href="#列表视图">列表视图</a></li>
    <li><a id="contents:我的视图" href="#我的视图">我的视图</a></li>
  </ol>
</nav><div class="post-body e-content">
              <h1 id="搭建基于tomcat的webapp"><a href="#搭建基于tomcat的webapp" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:搭建基于tomcat的webapp" class="headings">搭建基于tomcat的webapp</a></h1>
<h2 id="节点信息"><a href="#节点信息" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:节点信息" class="headings">节点信息</a></h2>
<ul>
<li>tomcat1：192.168.80.104</li>
<li>tomcat2：192.168.80.105</li>
<li>haproxy1+keepalived1：192.168.80.104</li>
<li>haproxy2+keepalived2：192.168.80.105</li>
</ul>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201218154304160.png" alt="image-20201218154304160"></p>
<h2 id="安装jdk"><a href="#安装jdk" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:安装jdk" class="headings">安装jdk</a></h2>
<ol>
<li>
<p>安装openjdk</p>
<pre><code>[root@web1-ha1 ~]# yum install -y java-1.8.0-openjdk-devel
   
</code></pre></li>
<li>
<p>配置java环境变量</p>
<pre><code>[root@web1-ha1 ~]# vim /etc/profile.d/java.sh 
[root@web1-ha1 ~]# cat /etc/profile.d/java.sh 
export JAVA_HOME=/usr/lib/jvm/java-1.8.0
export PATH=$JAVA_HOME/bin:$PATH
   
[root@web1-ha1 ~]# source !$
source /etc/profile.d/java.sh
[root@web1-ha1 ~]# echo $JAVA_HOME
/usr/lib/jvm/java-1.8.0
[root@web1-ha1 ~]# java -version
openjdk version &quot;1.8.0_262&quot;
OpenJDK Runtime Environment (build 1.8.0_262-b10)
OpenJDK 64-Bit Server VM (build 25.262-b10, mixed mode)
   
另一台相同操作即可
</code></pre></li>
</ol>
<h2 id="安装tomcat"><a href="#安装tomcat" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:安装tomcat" class="headings">安装tomcat</a></h2>
<ol>
<li>
<p>安装tomcat</p>
<pre><code>[root@web1-ha1 ~]# tar -xf apache-tomcat-8.5.57.tar.gz -C /usr/local/
[root@web1-ha1 ~]# ll /usr/local/
   
[root@web1-ha1 ~]# ln -sv /usr/local/apache-tomcat-8.5.57/ /usr/local/tomcat
‘/usr/local/tomcat’ -&gt; ‘/usr/local/apache-tomcat-8.5.57/’
   
</code></pre></li>
<li>
<p>配置tomcat环境变量</p>
<pre><code>[root@web1-ha1 ~]# vim /etc/profile.d/tomcat.sh
[root@web1-ha1 ~]# source !$
source /etc/profile.d/tomcat.sh
   
[root@web1-ha1 ~]# cat /etc/profile.d/tomcat.sh 
export CATALINA_BASE=/usr/local/tomcat
export CATALINA_HOME=/usr/local/tomcat
export PATH=$CATALINA_BASE/bin:$PATH
   
   
[root@web1-ha1 ~]# catalina.sh start
Using CATALINA_BASE:   /usr/local/tomcat
Using CATALINA_HOME:   /usr/local/tomcat
Using CATALINA_TMPDIR: /usr/local/tomcat/temp
Using JRE_HOME:        /usr/lib/jvm/java-1.8.0
Using CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar
Tomcat started.
[root@web1-ha1 ~]# ss -nlt
State      Recv-Q Send-Q                          Local Address:Port                                         Peer Address:Port              
LISTEN     0      128                                         *:22                                                      *:*                  
LISTEN     0      100                                 127.0.0.1:25                                                      *:*                  
LISTEN     0      1                            ::ffff:127.0.0.1:8005                                                   :::*                  
LISTEN     0      100                                        :::8080                                                   :::*                  
LISTEN     0      128                                        :::22                                                     :::*                  
LISTEN     0      100                                       ::1:25                                                     :::*   
</code></pre></li>
<li>
<p>访问测试</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201218160356589.png" alt="image-20201218160356589"></p>
</li>
</ol>
<h2 id="自定义webapp应用"><a href="#自定义webapp应用" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:自定义webapp应用" class="headings">自定义webapp应用</a></h2>
<ol>
<li>
<p>修改webapp的入口文件index.jsp</p>
<pre><code>[root@web2-ha2 ROOT]# cd /usr/local/tomcat/webapps/ROOT/
[root@web2-ha2 ROOT]# mv index.jsp index.jsp.bak
[root@web2-ha2 ROOT]# echo web2-ha2 &gt; index.jsp
   
[root@web1-ha1 ROOT]# cd /usr/local/tomcat/webapps/ROOT/
[root@web1-ha1 ROOT]# mv index.jsp index.jsp.bak
[root@web1-ha1 ROOT]# echo web1-ha1 &gt; index.jsp
   
# 2台tomcat webapp分别定义不同的首页，用于区分
</code></pre></li>
<li>
<p>重启测试</p>
</li>
</ol>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201220110941441.png" alt="image-20201220110941441"></p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201220110919071.png" alt="image-20201220110919071"></p>
<h2 id="部署keepalived"><a href="#部署keepalived" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:部署keepalived" class="headings">部署keepalived</a></h2>
<ol>
<li>
<p>安装keepalived1</p>
<pre><code>[root@web1-ha1 conf]# yum install -y keepalived
   
</code></pre></li>
<li>
<p>修改配置文件</p>
<pre><code>[root@web1-ha1 conf]# cat /etc/keepalived/keepalived.conf 
! Configuration File for keepalived
...
vrrp_instance VI_1 {
    state MASTER
    interface eth0
    virtual_router_id 51
    priority 80
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass 1111
    }
    virtual_ipaddress {
        192.168.80.200 dev eth0 label eth0:0
    }
}
   
[root@web1-ha1 conf]# systemctl start keepalived
   
</code></pre></li>
<li>
<p>部署keepalived2</p>
<pre><code>[root@web2-ha2 ROOT]# yum install -y keepalived
[root@web2-ha2 ROOT]# cat /etc/keepalived/keepalived.conf 
! Configuration File for keepalived
...
vrrp_instance VI_1 {
    state MASTER
    interface eth0
    virtual_router_id 51
    priority 100
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass 1111
    }
    virtual_ipaddress {
        192.168.80.200 dev eth0 label eth0:0
    }
}
   
[root@web2-ha2 ROOT]# systemctl start keepalived
[root@web2-ha2 ROOT]# ifconfig -a
   
eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.80.200  netmask 255.255.255.255  broadcast 0.0.0.0
        ether 00:0c:29:a5:67:42  txqueuelen 1000  (Ethernet)
# ha2的优先级比较高，所以ha2先获得vip        
</code></pre></li>
</ol>
<h2 id="部署haproxy"><a href="#部署haproxy" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:部署haproxy" class="headings">部署haproxy</a></h2>
<ol>
<li>
<p>部署haproxy1</p>
<pre><code>yum install -y haproxy
   
 vim /etc/haproxy/haproxy.cfg 
 # 将2个tomcat的webapp定义一个后端主机组，进行转发
 listen tomcat_web
        bind 0.0.0.0:80
        mode http
        log global
        option httplog
        server 192.168.80.104 192.168.80.104:8080 check
        server 192.168.80.105 192.168.80.105:8080 check
   
# 配置rsyslog接收haproxy的日志
# Provides UDP syslog reception
$ModLoad imudp
$UDPServerRun 514
   
# Provides TCP syslog reception
$ModLoad imtcp
$InputTCPServerRun 514
local2.*                       /var/log/haproxy.log
   
   
# 重启haproxy和rsyslog服务
   
systemctl restart rsyslog
systemctl restart haproxy
   
</code></pre></li>
<li>
<p>部署haproxy2</p>
<pre><code>和部署haproxy1完全一致，只是监听的是vip，只有vip所在的haproxy会收到流量，并进行转发
</code></pre></li>
<li>
<p>访问测试</p>
<pre><code>[root@dev-machine ~]# curl 192.168.80.200
web1-ha1
[root@dev-machine ~]# curl 192.168.80.200
web2-ha2
[root@dev-machine ~]# curl 192.168.80.200
web1-ha1
[root@dev-machine ~]# curl 192.168.80.200
web2-ha2
[root@dev-machine ~]# curl 192.168.80.200
web1-ha1
[root@dev-machine ~]# curl 192.168.80.200
web2-ha2
</code></pre></li>
</ol>
<h1 id="jenkins基础使用"><a href="#jenkins基础使用" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:jenkins基础使用" class="headings">Jenkins基础使用</a></h1>
<h2 id="安装gitlab相关插件"><a href="#安装gitlab相关插件" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:安装gitlab相关插件" class="headings">安装gitlab相关插件</a></h2>
<p>系统管理-》插件管理-》可选插件部分，搜索安装以下4个插件，（插件安装会自动安装依赖的插件）</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201220125434792.png" alt="image-20201220125434792"></p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201220125628805.png" alt="image-20201220125628805"></p>
<h2 id="用户权限管理"><a href="#用户权限管理" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:用户权限管理" class="headings">用户权限管理</a></h2>
<ol>
<li>
<p>安装权限管理插件role-based authorization strategy</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221153205497.png" alt="image-20201221153205497"></p>
</li>
<li>
<p>修改认证方式：系统管理-》全局安全配置</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221153349179.png" alt="image-20201221153349179"></p>
</li>
<li>
<p>创建Jenkins角色，给角色配置权限，（全局或项目范围内的读、写、更新等）</p>
<p>此时安全管理界面应该有管理用户和角色的选项，此处加了个custom-role，并赋予了全局范围内的读权限</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221153554826.png" alt="image-20201221153554826"></p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221153837976.png" alt="image-20201221153837976"></p>
</li>
<li>
<p>创建Jenkins用户；</p>
<p><img src="C:%5CUsers%5Cten%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201221153954730.png" alt="image-20201221153954730"></p>
</li>
<li>
<p>将用户关联到角色</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221154310911.png" alt="image-20201221154310911"></p>
</li>
<li>
<p>新用户登陆测试</p>
<p><img src="C:%5CUsers%5Cten%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201221154339690.png" alt="image-20201221154339690"></p>
</li>
</ol>
<h2 id="jenkins邮箱配置"><a href="#jenkins邮箱配置" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:jenkins邮箱配置" class="headings">Jenkins邮箱配置</a></h2>
<ol>
<li>开启网易或qq邮箱的smtp服务，并获得授权密码</li>
<li>配置Jenkins：（在系统配置中）
<ol>
<li>Jenkins location</li>
<li>Jenkins的邮件通知</li>
</ol>
</li>
<li>发送测试邮件，并查看</li>
</ol>
<p>Jenkins location和邮件通知配置如下：</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221161730631.png" alt="image-20201221161730631"></p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221161544491.png" alt="image-20201221161544491"></p>
<p>查看收到的测试邮件</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221161213252.png" alt="image-20201221161213252"></p>
<h2 id="jenkins配置ssh-key拉取gitlab代码"><a href="#jenkins配置ssh-key拉取gitlab代码" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:jenkins配置ssh-key拉取gitlab代码" class="headings">Jenkins配置ssh-key拉取gitlab代码</a></h2>
<ol>
<li>
<p>Jenkins主机生成ssh-key</p>
<pre><code>[root@jenkins-1 ~]# ssh-keygen -t rsa
[root@jenkins-1 ~]# cat .ssh/id_rsa.pub 
</code></pre></li>
<li>
<p>将Jenkins主机的key添加到gitlab中</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221163852994.png" alt="image-20201221163852994"></p>
</li>
<li>
<p>Jenkins主机拉取gitlab项目测试</p>
<pre><code>[root@jenkins-1 ~]# git clone git@192.168.80.102:mygroup1/myproject1.git
Cloning into 'myproject1'...
   
drwxr-xr-x  3 root root   53 Dec 21 16:35 myproject1
</code></pre></li>
</ol>
<h2 id="jenkins配置ssh-key类型凭证"><a href="#jenkins配置ssh-key类型凭证" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:jenkins配置ssh-key类型凭证" class="headings">jenkins配置ssh-key类型凭证</a></h2>
<ol>
<li>
<p>安装credentials binding 插件</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221181943179.png" alt="image-20201221181943179"></p>
</li>
<li>
<p>安全-》凭据配置里，管理员账户添加可以创建的：凭证的提供者，和其类型，（全选）</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221181910832.png" alt="image-20201221181910832"></p>
</li>
<li>
<p>安全-》manage credential里，添加某类型的具体的凭证（截图有误，应该填入gitlab的ssh-key对应的私钥！）</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221181846530.png" alt="image-20201221181846530"></p>
</li>
<li>
<p>创建测试项目test-demo1，没有报错，基本证实该key没有问题</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221182723347.png" alt="image-20201221182723347"></p>
</li>
<li>
<p>点击立即构建，查看构建结果，Jenkins主机上的工作目录下，生成对应目录</p>
<pre><code>[root@jenkins-1 ~]# ll /var/lib/jenkins/workspace/
total 0
drwxr-xr-x 3 jenkins jenkins 53 Dec 21 18:27 test-demo1
drwxr-xr-x 2 jenkins jenkins  6 Dec 21 18:27 test-demo1@tmp
</code></pre></li>
<li>
<p>查看，控制台输出，证明该凭证，可以正常使用</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221182920612.png" alt="image-20201221182920612"></p>
</li>
</ol>
<h2 id="构建后shell脚本"><a href="#构建后shell脚本" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:构建后shell脚本" class="headings">构建后shell脚本</a></h2>
<blockquote>
<p>shell脚本，将构建后的web包，（这里只有一个index.jsp模拟）拷贝到2台tomcat服务器上，重启tomcat，实现webapp的更新</p>
</blockquote>
<p>脚本如下：</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221190051776.png" alt="image-20201221190051776"></p>
<p>保存后，点击立即构建，依次检查Jenkins控制台输出、Jenkins的工作目录、webapp的页面，发现shell执行结果均符合预期，下方为更新后tomcat app的访问截图：</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221185947319.png" alt="image-20201221185947319"></p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201221185939578.png" alt="image-20201221185939578"></p>
<h1 id="jenkins触发器"><a href="#jenkins触发器" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:jenkins触发器" class="headings">Jenkins触发器</a></h1>
<h2 id="触发器简介"><a href="#触发器简介" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:触发器简介" class="headings">触发器简介</a></h2>
<p>​	Jenkins的触发器可以实现，当满足特定的条件时，触发相应操作，eg：只有dev分支的代码设置触发器，当有新代码提交时，会触发Jenkins拉取代码，构建，然后自动部署到测试环境，而正式环境的代码需要手动确认后再部署到正式环境；</p>
<p>图示：</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222103643458.png" alt="image-20201222103643458"></p>
<h2 id="触发器种类"><a href="#触发器种类" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:触发器种类" class="headings">触发器种类</a></h2>
<ul>
<li>触发远程构建：gitlab在检测到某库提交代码后，通过jenkins给出的url和token发起调用，之后jenkins就可以来gitlab拉取代码，进行后续构建操作；</li>
<li>其他工程构建后触发：build after other projects are build，</li>
<li>定时构建：build periodlcally</li>
<li>轮询scm，（对代码库轮询，检查是否有代码提交，对jenkins资源消耗较大）</li>
</ul>
<h2 id="触发器webhook设置"><a href="#触发器webhook设置" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:触发器webhook设置" class="headings">触发器webhook设置</a></h2>
<ol>
<li>
<p>gitlab上给项目，新建dev分支；</p>
</li>
<li>
<p>jenkins安装插件：gitlab hook，gitlab authentication；</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222112951995.png" alt="image-20201222112951995"></p>
</li>
<li>
<p>修改jenkins配置</p>
<ol>
<li>
<p>登陆策略改为：登陆用户可以做任何事</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222113214450.png" alt="image-20201222113214450"></p>
</li>
<li>
<p>取消勾选：防止跨站点请求伪造（263版本没找到，后续通过命令行关闭）</p>
</li>
<li>
<p>保存配置</p>
</li>
</ol>
</li>
<li>
<p>jenkins新建job，拉取代码选择分支为：dev</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222122842520.png" alt="image-20201222122842520"></p>
<ol>
<li>
<p>构建shell，使用echo一个环境变量用于测试</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222135751403.png" alt="image-20201222135751403"></p>
</li>
<li>
<p>openssl生成一个字符串做token</p>
<pre><code>[root@jenkins-1 ~]# openssl rand -hex 12
5ea30da8af91cf0adc527336
      
</code></pre></li>
<li>
<p>配置jenkins job时选择：触发远程构建，将上步的token填入</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222135657676.png" alt="image-20201222135657676"></p>
</li>
</ol>
</li>
<li>
<p>curl命令访问jenkins的url，curl访问会触发构建</p>
<pre><code>[root@gitlab ~]# curl http://192.168.80.101:8080/job/dev-webhook/build?token=5ea30da8af91cf0adc527336
</code></pre></li>
<li>
<p>查看项目下是否有新的构建序号#N</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222135418655.png" alt="image-20201222135418655"></p>
</li>
<li>
<p>gitlab配置webhook，在admin area-》system hook中配置</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222142827860.png" alt="image-20201222142827860"></p>
</li>
<li>
<p>gitlab测试webhook可用性</p>
<p>首次测试异常：报错403，“Hook executed successfully but returned HTTP 403... No valid crumb was included in the request”</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222143110199.png" alt="image-20201222143110199"></p>
<p>根据google查得，是csrf没关闭的导致，本应在全局安全配置中可以关闭，但是Jenkins2.263.1版本没有找到该选项，另一种方法，命令方式关闭（在jenkins的命令行窗口输入以下命令，并执行）</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222141902445.png" alt="image-20201222141902445"></p>
<p>再次测试正常：</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222141719048.png" alt="image-20201222141719048"></p>
</li>
<li>
<p>更新jenkins job的构建shell，为正式的构建、打包、部署命令</p>
<pre><code>cd /var/lib/jenkins/workspace/dev-webhook
tar -czvf web1.tar.gz index.jsp
scp web1.tar.gz root@192.168.80.104:/usr/local/tomcat/webapps/ROOT/
scp web1.tar.gz root@192.168.80.105:/usr/local/tomcat/webapps/ROOT/
   
ssh root@192.168.80.104 &quot;catalina.sh stop &amp;&amp; tar -xf /usr/local/tomcat/webapps/ROOT/web1.tar.gz -C /tmp/ &amp;&amp; cp -a /tmp/index.jsp /usr/local/tomcat/webapps/ROOT/index.jsp&quot;
ssh root@192.168.80.105 &quot;catalina.sh stop &amp;&amp; tar -xf /usr/local/tomcat/webapps/ROOT/web1.tar.gz -C /tmp/ &amp;&amp; cp -a /tmp/index.jsp /usr/local/tomcat/webapps/ROOT/index.jsp&quot;
   
ssh root@192.168.80.104 &quot;catalina.sh start&quot;
ssh root@192.168.80.105 &quot;catalina.sh start&quot;
</code></pre></li>
<li>
<p>gitlab提交代码到dev分支</p>
<p>1、开发者本地生成密钥，并将密钥的公钥上传到自己gitlab账户的ssh-key中；</p>
<p>2、项目经理赋予开发者某个项目的一定的权限，如开发权限；</p>
<p>3、开发者本地配置user.name 和user.email，和gitlab账户保持一致；</p>
<p>4、之后，开发者即可将某具有开发权限的项目拉取到本地、开发、提交、推送；</p>
<pre><code>[pm@dev-machine ~]$ cat .gitconfig 
[user]
    name = pm
    email = pm@bo.com
[pm@dev-machine ~]$ git clone git@192.168.80.102:mygroup1/myproject1.git
Cloning into 'myproject1'...
    
    
[pm@dev-machine ~]$ cd myproject1/
[pm@dev-machine myproject1]$ vim index.jsp # 添加一行；and this is dev branch app
[pm@dev-machine myproject1]$ git add index.jsp 
[pm@dev-machine myproject1]$ git commit -m &quot;add one line in dev branch&quot;
    
[pm@dev-machine myproject1]$ git push
    
</code></pre></li>
<li>
<p>查看jenkins是否被gitlab调用webhook从而触发自动构建</p>
<p>gitlab已经更新</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222145705844.png" alt="image-20201222145705844"></p>
<p>jenkins随即进行了新的构建，说明webhook成功调用</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222145806495.png" alt="image-20201222145806495"></p>
</li>
<li>
<p>访问tomcat，查看webapp是否更新</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222153408963.png" alt="image-20201222153408963"></p>
</li>
<li>
<p>实验中问题：</p>
<ol>
<li>2个tomcat未设置开机自启动，所以第一次构建总失败，因为catalina.sh stop会失败，后续脚本失败</li>
<li>开发提交的的是master分支，而之前设置的自动触发拉取的是dev分支，所以webapp总是不更新，</li>
<li>第四次提交，最终实现自动触发jenkins构建，并成功部署到tomcat 服务器；</li>
</ol>
</li>
</ol>
<h2 id="构建后项目关联"><a href="#构建后项目关联" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:构建后项目关联" class="headings">构建后项目关联</a></h2>
<p>​	用于多个Jenkins的job关联执行，如job1执行后且成功执行后触发执行job2；</p>
<p>在构建后操作中配置，需要构建的其他相关job，且可以选择当前项目的构建状态处于什么情况下，触发构建其相关job</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222154208757.png" alt="image-20201222154208757"></p>
<ol>
<li>
<p>点击立即构建</p>
</li>
<li>
<p>查看控制台输出</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222154516647.png" alt="image-20201222154516647"></p>
</li>
<li>
<p>查看pm-project2是否被关联构建</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222154502371.png" alt="image-20201222154502371"></p>
</li>
</ol>
<h1 id="jenkins分布式集群构建"><a href="#jenkins分布式集群构建" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:jenkins分布式集群构建" class="headings">Jenkins分布式集群构建</a></h1>
<p>​	job增多时，单jenkins实例会影响项目的构建和部署效率，因此jenkins提供了Jenkins主从集群架构，将多个job分发给多个slave节点执行，挺高了并发能力，和执行效率；</p>
<h2 id="配置slave节点"><a href="#配置slave节点" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:配置slave节点" class="headings">配置slave节点</a></h2>
<ol>
<li>
<p>安装jdk环境，配置java环境变量</p>
<pre><code>[root@web1-ha1 ROOT]# java -version
openjdk version &quot;1.8.0_262&quot;
OpenJDK Runtime Environment (build 1.8.0_262-b10)
OpenJDK 64-Bit Server VM (build 25.262-b10, mixed mode)
[root@web1-ha1 ROOT]# echo $JAVA_HOME
/usr/lib/jvm/java-1.8.0
   
# 这里采用和tomcat服务器同一个机器
</code></pre></li>
<li>
<p>安装git，根据需要还可能安装maven等编译打包工具</p>
<pre><code>[root@web1-ha1 ROOT]# yum install -y git
   
</code></pre></li>
<li>
<p>创建jenkins的工作目录</p>
<pre><code>   
# 要和jenkins主节点的数据目录保持一致/var/lib/jenkins，注意权限
</code></pre></li>
<li>
<p>主节点上：</p>
<ol>
<li>
<p>添加slave凭证，ssh类型，即slave节点的root用户和其登陆密码即可</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222160234405.png" alt="image-20201222160234405"></p>
</li>
<li>
<p>添加slave节点</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222160458710.png" alt="image-20201222160458710"></p>
</li>
<li>
<p>查看slave状态是否正常</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222160532068.png" alt="image-20201222160532068"></p>
</li>
</ol>
</li>
<li>
<p>slave节点查看进程是否正常</p>
<pre><code>[root@web1-ha1 ROOT]# ps -ef|grep jenkins
root       2105   2059  0 16:04 ?        00:00:00 bash -c cd &quot;/var/lib/jenkins&quot; &amp;&amp; java  -jar remoting.jar -workDir /var/lib/jenkins -jar-cache /var/lib/jenkins/remoting/jarCache
root       2112   2105 10 16:04 ?        00:00:08 java -jar remoting.jar -workDir /var/lib/jenkins -jar-cache /var/lib/jenkins/remoting/jarCache
   
# slave节点不需要安装Jenkins，而是执行master节点的remoter.jar包即可
</code></pre></li>
<li>
<p>配置job在slave节点上执行</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222161212519.png" alt="image-20201222161212519"></p>
</li>
<li>
<p>点击立即构建，并查看日志</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222161152581.png" alt="image-20201222161152581"></p>
</li>
<li>
<p>构建后，slave节点也生成了相应的工作目录</p>
<pre><code>[root@web1-ha1 ROOT]# ll /var/lib/jenkins/remoting
total 0
drwxr-xr-x 17 root root 156 Dec 22 16:04 jarCache
drwxr-xr-x  2 root root  54 Dec 22 16:04 logs
[root@web1-ha1 ROOT]# ll /var/lib/jenkins/
total 1488
drwxr-xr-x 4 root root      34 Dec 22 16:04 remoting
-rw-r--r-- 1 root root 1521553 Dec 22 16:04 remoting.jar
drwxr-xr-x 4 root root      48 Dec 22 16:10 workspace
[root@web1-ha1 ROOT]# ll /var/lib/jenkins/workspace/
total 0
drwxr-xr-x 3 root root 35 Dec 22 16:10 pm-project2
drwxr-xr-x 2 root root  6 Dec 22 16:10 pm-project2@tmp
[root@web1-ha1 ROOT]# ll /var/lib/jenkins/workspace/pm-project2
total 4
-rw-r--r-- 1 root root 21 Dec 22 16:10 README.m
</code></pre></li>
</ol>
<h1 id="pipline"><a href="#pipline" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:pipline" class="headings">pipline</a></h1>
<h2 id="简介"><a href="#简介" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:简介" class="headings">简介</a></h2>
<p><a href="https://www.jenkins.io/doc/book/pipeline/" target="_blank" rel="noopener">https://www.jenkins.io/doc/book/pipeline/</a></p>
<blockquote>
<p>A <em>continuous delivery (CD) pipeline</em> is an automated expression of your process for getting software from version control right through to your users and customers. Every change to your software (committed in source control) goes through a complex process on its way to being released. This process involves building the software in a reliable and repeatable manner, as well as progressing the built software (called a &quot;build&quot;) through multiple stages of testing and deployment.</p>
<p>Pipeline provides an extensible set of tools for modeling simple-to-complex delivery pipelines &quot;as code&quot; via the <a href="https://www.jenkins.io/doc/book/pipeline/syntax" target="_blank" rel="noopener">Pipeline domain-specific language (DSL) syntax</a>. [<a href="https://www.jenkins.io/doc/book/pipeline/#_footnotedef_1" target="_blank" rel="noopener">1</a>]</p>
</blockquote>
<p>pipline支持2种方式，一是写在jenkins的job的piplin输入框内，适合测试；二是和代码一样写在ide中，并和代码一起提交到git等仓库中，方便管理，版本追踪等；</p>
<blockquote>
<p>开发要写的几个文件：</p>
<p>程序配置文件：定义程序的运行时特性；</p>
<p>jenkinsfile：定义如何构建程序包；</p>
<p>sonar-project.properties：定义如何用sonar扫描代码；</p>
<p>dockerfile：定义程序包如何和基础镜像、依赖包打包成镜像；</p>
<p>k8s的yaml文件：定义打包后的镜像如何在k8s集群中运行成容器的行为特性；</p>
</blockquote>
<h2 id="pipline语法"><a href="#pipline语法" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:pipline语法" class="headings">pipline语法</a></h2>
<p>常用的关键字：</p>
<ul>
<li>node：定义在哪些节点运行任务</li>
<li>stage：定义都有哪些阶段，如构建阶段、打包阶段、测试阶段、部署阶段等</li>
<li>step：处于stage内部，stage就是由一个一个的step组成，如编译一个step，scp拷包一个step</li>
</ul>
<h2 id="pipline简单测试"><a href="#pipline简单测试" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:pipline简单测试" class="headings">pipline简单测试</a></h2>
<p>1，新建demo项目</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222162702295.png" alt="image-20201222162702295"></p>
<p>2，写入pipline语句</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222162922286.png" alt="image-20201222162922286"></p>
<p>3，构建测试，成功</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222163037525.png" alt="image-20201222163037525"></p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222163028400.png" alt="image-20201222163028400"></p>
<h2 id="生成拉取代码的pipline语句"><a href="#生成拉取代码的pipline语句" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:生成拉取代码的pipline语句" class="headings">生成拉取代码的pipline语句</a></h2>
<p>​	jenkins支持代码生成器，可以生成代码片段，只需稍作修改即可使用</p>
<ol>
<li>
<p>生成拉取git仓库的代码</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222163915687.png" alt="image-20201222163915687"></p>
</li>
<li>
<p>复制代码片段到脚本框中使用，点击构建</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222164342638.png" alt="image-20201222164342638"></p>
</li>
<li>
<p>执行是在slave1上，</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222164421018.png" alt="image-20201222164421018"></p>
<pre><code>[root@web1-ha1 ROOT]# ll /var/lib/jenkins/workspace/pipline-demo1
total 8
-rw-r--r-- 1 root root 93 Dec 22 16:41 index.jsp
-rw-r--r-- 1 root root  1 Dec 22 16:41 README.md
   
</code></pre></li>
</ol>
<h2 id="pipline做完整的代码部署流程"><a href="#pipline做完整的代码部署流程" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:pipline做完整的代码部署流程" class="headings">pipline做完整的代码部署流程</a></h2>
<ol>
<li>
<p>更新gitlab代码</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222170259808.png" alt="image-20201222170259808"></p>
</li>
<li>
<p>准备pipline脚本</p>
<pre><code>node {
    stage(&quot;code clone&quot;){
        echo &quot;code clone&quot;
        sh 'rm -rf /var/lib/jenkins/workspace/pipline-demo1/*'
        git credentialsId: 'b20fdd14-dec6-4afa-b5d0-e14cb8e063a2', url: 'git@192.168.80.102:mygroup1/myproject1.git'
    }
       
    stage(&quot;code deploy&quot;){
        echo &quot;code build&quot;
        sh 'cd /var/lib/jenkins/workspace/pipline-demo1/ &amp;&amp; scp index.jsp root@192.168.80.104:/usr/local/tomcat/webapps/ROOT/index.jsp'
        sh 'cd /var/lib/jenkins/workspace/pipline-demo1/ &amp;&amp; scp index.jsp root@192.168.80.105:/usr/local/tomcat/webapps/ROOT/index.jsp'
           
    }
    stage(&quot;tomcat restart&quot;){
        sh 'ssh 192.168.80.104 &quot;catalina.sh stop &amp;&amp; catalina.sh start&quot;'
        sh 'ssh 192.168.80.105 &quot;catalina.sh stop &amp;&amp; catalina.sh start&quot;'
    }
     
}
</code></pre></li>
<li>
<p>slave1节点需要做到2个tomcat服务器的免密登陆，方便scp程序包</p>
<pre><code>[root@web1-ha1 ROOT]# ssh-copy-id 192.168.80.105
[root@web1-ha1 ROOT]# ssh-copy-id 192.168.80.104
   
</code></pre></li>
<li>
<p>查看tomcat的webapp是否更新</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222170030916.png" alt="image-20201222170030916"></p>
</li>
<li>
<p>指定运行节点：node中指定了master节点运行该job</p>
<pre><code>node(&quot;master&quot;) {
    stage(&quot;code clone&quot;){
        echo &quot;code clone&quot;
        sh 'rm -rf /var/lib/jenkins/workspace/pipline-demo1/*'
        git credentialsId: 'b20fdd14-dec6-4afa-b5d0-e14cb8e063a2', url: 'git@192.168.80.102:mygroup1/myproject1.git'
    }
       
    stage(&quot;code deploy&quot;){
        echo &quot;code build&quot;
        sh 'cd /var/lib/jenkins/workspace/pipline-demo1/ &amp;&amp; scp index.jsp root@192.168.80.104:/usr/local/tomcat/webapps/ROOT/index.jsp'
        sh 'cd /var/lib/jenkins/workspace/pipline-demo1/ &amp;&amp; scp index.jsp root@192.168.80.105:/usr/local/tomcat/webapps/ROOT/index.jsp'
           
    }
    stage(&quot;tomcat restart&quot;){
        sh 'ssh 192.168.80.104 &quot;catalina.sh stop &amp;&amp; catalina.sh start&quot;'
        sh 'ssh 192.168.80.105 &quot;catalina.sh stop &amp;&amp; catalina.sh start&quot;'
    }
     
}
</code></pre><p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222170440452.png" alt="image-20201222170440452"></p>
</li>
</ol>
<h1 id="jenkins视图"><a href="#jenkins视图" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:jenkins视图" class="headings">Jenkins视图</a></h1>
<p>​	jenkins可以将job进行分类归档，方便查看，如一个业务的所有job做一个视图，当前用户能查看的所有job放在一个视图（默认具有）；主要有三类视图：</p>
<ul>
<li>pipline视图</li>
<li>列表视图</li>
<li>我的视图</li>
</ul>
<h2 id="pipline视图"><a href="#pipline视图" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:pipline视图" class="headings">pipline视图</a></h2>
<ol>
<li>
<p>安装build pipline插件；</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222171115778.png" alt="image-20201222171115778"></p>
</li>
<li>
<p>创建pipline类型的视图；</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222171838919.png" alt="image-20201222171838919"></p>
</li>
<li>
<p>查看视图；视图当中列出了所有构建</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222172033337.png" alt="image-20201222172033337"></p>
</li>
</ol>
<h2 id="列表视图"><a href="#列表视图" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:列表视图" class="headings">列表视图</a></h2>
<p>创建时选择类型为：列表视图</p>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222175734878.png" alt="image-20201222175734878"></p>
<h2 id="我的视图"><a href="#我的视图" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:我的视图" class="headings">我的视图</a></h2>
<p><img src="https://gitee.com/boogie96/img/raw/master/img/image-20201222175644276.png" alt="image-20201222175644276"></p>
<h1 id="jenkins基于脚本实现参数化代码部署与回滚"><a href="#jenkins基于脚本实现参数化代码部署与回滚" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="#contents:jenkins基于脚本实现参数化代码部署与回滚" class="headings">Jenkins基于脚本实现参数化代码部署与回滚</a></h1>
<p><a href="https://www.cnblogs.com/struggle-1216/p/12447304.html" target="_blank" rel="noopener">参考博客</a></p>

            </div>

            
    
    
        <ul class="post-copyright">
            <li class="copyright-item author"><span class="copyright-item-text">作者</span>：<a href="latteStudio.github.io" class="p-author h-card" target="_blank" rel="noopener">latteStudio</a></li>
            
                
                
                
                
                <li class="copyright-item link"><span class="copyright-item-text">链接</span>：<a href="/posts/jenkins%E4%B9%8Bpipline%E5%9F%BA%E7%A1%80/" target="_blank" rel="noopener">https://latteStudio.github.io/posts/jenkins之pipline基础/</a></li>
            
            <li class="copyright-item license"><span class="copyright-item-text">许可</span>：<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a></li>
            
        </ul>
    



        </article>

        

        
    <div class="updated-badge-container">
        <span title="Updated @ 2020-12-24 14:41:44 CST" style="cursor:help">

<svg xmlns="http://www.w3.org/2000/svg" width="130" height="20" class="updated-badge"><linearGradient id="b" x2="0" y2="100%"><stop offset="0" stop-color="#bbb" stop-opacity=".1"/><stop offset="1" stop-opacity=".1"/></linearGradient><clipPath id="a"><rect width="130" height="20" rx="3" fill="#fff"/></clipPath><g clip-path="url(#a)"><path class="updated-badge-left" d="M0 0h55v20H0z"/><path class="updated-badge-right" d="M55 0h75v20H55z"/><path fill="url(#b)" d="M0 0h130v20H0z"/></g><g fill="#fff" text-anchor="middle" font-size="110"><text x="285" y="150" fill="#010101" fill-opacity=".3" textLength="450" transform="scale(.1)">updated</text><text x="285" y="140" textLength="450" transform="scale(.1)">updated</text><text x="915" y="150" fill="#010101" fill-opacity=".3" textLength="650" transform="scale(.1)">2020-12-24</text><text x="915" y="140" textLength="650" transform="scale(.1)">2020-12-24</text></g></svg>
        </span></div>



        


        <div class="post-share">

        

        <div class="share-items">

            

            

            

            

            

            

            

            

            

        </div>

    </div>




        
    
    
        <div class="related-posts">
            <h2 class="related-title">相关文章：<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"/></svg></h2>
            <ul class="related-list">
                
                    <li class="related-item">
                        <a href="/posts/jenkins%E9%9B%86%E6%88%90sonarqube%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5/" class="related-link">jenkins集成sonarqube代码审查</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/jenkins%E9%83%A8%E7%BD%B2%E5%8D%87%E7%BA%A7/" class="related-link">jenkins部署升级</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/gitlab%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/" class="related-link">gitlab备份恢复</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/gitlab%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" class="related-link">gitlab权限管理</a>
                    </li>
                
                    <li class="related-item">
                        <a href="/posts/gitlab%E9%83%A8%E7%BD%B2/" class="related-link">gitlab部署</a>
                    </li>
                
            </ul>
        </div>
    



        
    
        <div class="post-tags">
            
                
                
                
                
                    
                    <a href="/tags/jenkins/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>jenkins</a>
                
            
                
                
                
                
                    
                    <a href="/tags/ci/cd/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>ci/cd</a>
                
            
        </div>
    



        


        


        
    
        
        
    
    
    
    
        <ul class="post-nav">
            
                <li class="post-nav-prev">
                    <a href="/posts/jenkins%E9%9B%86%E6%88%90sonarqube%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5/" rel="prev">&lt; jenkins集成sonarqube代码审查</a>
                </li>
            
            
                <li class="post-nav-next">
                    <a href="/posts/nginx%E4%BB%A3%E7%90%86kibana/" rel="next">nginx代理kibana &gt;</a>
                </li>
            
        </ul>
    



        


    </div>
</main>


            
    <div id="back-to-top" class="back-to-top">
        <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a>
    </div>


            
    <footer id="footer" class="footer">
        <div class="footer-inner">
            <div class="site-info">©&nbsp;2019–2021&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;latteStudio</div><div class="powered-by">Powered by <a href="https://github.com/gohugoio/hugo" target="_blank" rel="noopener">Hugo</a> | Theme is <a href="https://github.com/reuixiy/hugo-theme-meme" target="_blank" rel="noopener">MemE</a></div>

            


            
        </div>
    </footer>


        </div>
        

        








    <script src="https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js"></script>

<script>
    mediumZoom(document.querySelectorAll('div.post-body img'), {
        background: 'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'
    })
</script>




    <script src="https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js" type="module" defer></script>







    </body>
</html>
